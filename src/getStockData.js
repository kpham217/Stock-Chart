import React, { useState, useEffect } from 'react'
import { timeParse } from "d3-time-format";
export async function Getstockdata(symbol) {
    const API_KEY = 'H21T6LC1K3QPU5EI'
    const stock_symbol = 'TSLA'
    let period = [];
    let closeValues = [];
    let openValues = [];
    let highValues = [];
    let lowValues = [];
    let volumeValues = [];
    let resultdata = [];

    try{
        console.log('executed');
        // await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${stock_symbol}&interval=5min&apikey=${API_KEY}`)
        // .then(function(res) {
        //     return res.json();
        // })
        // .then(data => {
        //     console.log(data)
        //     for (let x in data['Time Series (5min)']){
        //         resultdata.push({
        //             stock_symbol,
        //             date: new Date(x),
        //             open: data['Time Series (5min)'][x]['1. open'],
        //             high: data['Time Series (5min)'][x]['2. high'],
        //             low: data['Time Series (5min)'][x]['3. low'],
        //             close: data['Time Series (5min)'][x]['4. close'],
        //             volume: data['Time Series (5min)'][x]['5. volume']
        //         })
        //     }
        // })
        const data = {
            "Meta Data": {
                "1. Information": "Intraday (5min) open, high, low, close prices and volume",
                "2. Symbol": "IBM",
                "3. Last Refreshed": "2020-12-18 20:00:00",
                "4. Interval": "5min",
                "5. Output Size": "Compact",
                "6. Time Zone": "US/Eastern"
            },
            "Time Series (5min)": {
                "2020-12-18 20:00:00": {
                    "1. open": "125.9200",
                    "2. high": "125.9200",
                    "3. low": "125.9200",
                    "4. close": "125.9200",
                    "5. volume": "102"
                },
                "2020-12-18 19:30:00": {
                    "1. open": "126.0000",
                    "2. high": "126.0000",
                    "3. low": "126.0000",
                    "4. close": "126.0000",
                    "5. volume": "210"
                },
                "2020-12-18 18:40:00": {
                    "1. open": "126.0000",
                    "2. high": "126.0000",
                    "3. low": "126.0000",
                    "4. close": "126.0000",
                    "5. volume": "180"
                },
                "2020-12-18 18:20:00": {
                    "1. open": "125.9999",
                    "2. high": "125.9999",
                    "3. low": "125.9999",
                    "4. close": "125.9999",
                    "5. volume": "903"
                },
                "2020-12-18 17:45:00": {
                    "1. open": "126.1100",
                    "2. high": "126.1100",
                    "3. low": "126.1100",
                    "4. close": "126.1100",
                    "5. volume": "220"
                },
                "2020-12-18 17:10:00": {
                    "1. open": "125.9000",
                    "2. high": "125.9000",
                    "3. low": "125.9000",
                    "4. close": "125.9000",
                    "5. volume": "237"
                },
                "2020-12-18 17:05:00": {
                    "1. open": "125.9000",
                    "2. high": "125.9000",
                    "3. low": "125.9000",
                    "4. close": "125.9000",
                    "5. volume": "251"
                },
                "2020-12-18 17:00:00": {
                    "1. open": "126.1500",
                    "2. high": "126.1500",
                    "3. low": "126.1500",
                    "4. close": "126.1500",
                    "5. volume": "206"
                },
                "2020-12-18 16:55:00": {
                    "1. open": "125.9000",
                    "2. high": "125.9000",
                    "3. low": "125.8600",
                    "4. close": "125.8600",
                    "5. volume": "602"
                },
                "2020-12-18 16:50:00": {
                    "1. open": "126.1000",
                    "2. high": "126.1000",
                    "3. low": "126.0000",
                    "4. close": "126.0000",
                    "5. volume": "335"
                },
                "2020-12-18 16:40:00": {
                    "1. open": "126.1000",
                    "2. high": "126.1000",
                    "3. low": "126.1000",
                    "4. close": "126.1000",
                    "5. volume": "157"
                },
                "2020-12-18 16:30:00": {
                    "1. open": "126.1500",
                    "2. high": "126.1500",
                    "3. low": "126.1500",
                    "4. close": "126.1500",
                    "5. volume": "2945"
                },
                "2020-12-18 16:20:00": {
                    "1. open": "125.8500",
                    "2. high": "126.0000",
                    "3. low": "125.8374",
                    "4. close": "125.8374",
                    "5. volume": "84260"
                },
                "2020-12-18 16:10:00": {
                    "1. open": "125.8500",
                    "2. high": "125.8500",
                    "3. low": "125.8500",
                    "4. close": "125.8500",
                    "5. volume": "247955"
                },
                "2020-12-18 16:05:00": {
                    "1. open": "125.8500",
                    "2. high": "125.8500",
                    "3. low": "125.8500",
                    "4. close": "125.8500",
                    "5. volume": "223311"
                },
                "2020-12-18 16:00:00": {
                    "1. open": "126.0300",
                    "2. high": "126.4000",
                    "3. low": "125.8400",
                    "4. close": "125.9700",
                    "5. volume": "361732"
                },
                "2020-12-18 15:55:00": {
                    "1. open": "125.7400",
                    "2. high": "126.1500",
                    "3. low": "125.6400",
                    "4. close": "126.0300",
                    "5. volume": "135628"
                },
                "2020-12-18 15:50:00": {
                    "1. open": "125.5700",
                    "2. high": "125.8000",
                    "3. low": "125.4750",
                    "4. close": "125.7435",
                    "5. volume": "81076"
                },
                "2020-12-18 15:45:00": {
                    "1. open": "125.2900",
                    "2. high": "125.5900",
                    "3. low": "125.2700",
                    "4. close": "125.5600",
                    "5. volume": "76883"
                },
                "2020-12-18 15:40:00": {
                    "1. open": "125.3200",
                    "2. high": "125.3800",
                    "3. low": "125.2500",
                    "4. close": "125.2800",
                    "5. volume": "46032"
                },
                "2020-12-18 15:35:00": {
                    "1. open": "125.1250",
                    "2. high": "125.3400",
                    "3. low": "125.1250",
                    "4. close": "125.3325",
                    "5. volume": "37313"
                },
                "2020-12-18 15:30:00": {
                    "1. open": "125.2000",
                    "2. high": "125.2000",
                    "3. low": "125.0300",
                    "4. close": "125.1300",
                    "5. volume": "48019"
                },
                "2020-12-18 15:25:00": {
                    "1. open": "125.3600",
                    "2. high": "125.3800",
                    "3. low": "125.1600",
                    "4. close": "125.2000",
                    "5. volume": "34786"
                },
                "2020-12-18 15:20:00": {
                    "1. open": "125.2800",
                    "2. high": "125.4600",
                    "3. low": "125.2800",
                    "4. close": "125.3495",
                    "5. volume": "31455"
                },
                "2020-12-18 15:15:00": {
                    "1. open": "125.3700",
                    "2. high": "125.3700",
                    "3. low": "125.2000",
                    "4. close": "125.2700",
                    "5. volume": "34627"
                },
                "2020-12-18 15:10:00": {
                    "1. open": "125.3700",
                    "2. high": "125.4500",
                    "3. low": "125.3600",
                    "4. close": "125.3600",
                    "5. volume": "23692"
                },
                "2020-12-18 15:05:00": {
                    "1. open": "125.2800",
                    "2. high": "125.3820",
                    "3. low": "125.2400",
                    "4. close": "125.3650",
                    "5. volume": "23310"
                },
                "2020-12-18 15:00:00": {
                    "1. open": "125.3300",
                    "2. high": "125.3400",
                    "3. low": "125.2000",
                    "4. close": "125.2602",
                    "5. volume": "29349"
                },
                "2020-12-18 14:55:00": {
                    "1. open": "125.4900",
                    "2. high": "125.5100",
                    "3. low": "125.3100",
                    "4. close": "125.3100",
                    "5. volume": "32066"
                },
                "2020-12-18 14:50:00": {
                    "1. open": "125.5100",
                    "2. high": "125.5500",
                    "3. low": "125.4100",
                    "4. close": "125.5000",
                    "5. volume": "36671"
                },
                "2020-12-18 14:45:00": {
                    "1. open": "125.4400",
                    "2. high": "125.5500",
                    "3. low": "125.4200",
                    "4. close": "125.4800",
                    "5. volume": "19625"
                },
                "2020-12-18 14:40:00": {
                    "1. open": "125.4100",
                    "2. high": "125.4700",
                    "3. low": "125.3500",
                    "4. close": "125.4500",
                    "5. volume": "25853"
                },
                "2020-12-18 14:35:00": {
                    "1. open": "125.3430",
                    "2. high": "125.4800",
                    "3. low": "125.3400",
                    "4. close": "125.4000",
                    "5. volume": "24441"
                },
                "2020-12-18 14:30:00": {
                    "1. open": "125.3200",
                    "2. high": "125.3700",
                    "3. low": "125.2200",
                    "4. close": "125.3575",
                    "5. volume": "31776"
                },
                "2020-12-18 14:25:00": {
                    "1. open": "125.3400",
                    "2. high": "125.3800",
                    "3. low": "125.3000",
                    "4. close": "125.3200",
                    "5. volume": "38675"
                },
                "2020-12-18 14:20:00": {
                    "1. open": "125.4200",
                    "2. high": "125.4250",
                    "3. low": "125.2500",
                    "4. close": "125.3400",
                    "5. volume": "23364"
                },
                "2020-12-18 14:15:00": {
                    "1. open": "125.4150",
                    "2. high": "125.4600",
                    "3. low": "125.3300",
                    "4. close": "125.4169",
                    "5. volume": "33920"
                },
                "2020-12-18 14:10:00": {
                    "1. open": "125.2000",
                    "2. high": "125.4206",
                    "3. low": "125.2000",
                    "4. close": "125.4150",
                    "5. volume": "19500"
                },
                "2020-12-18 14:05:00": {
                    "1. open": "125.3900",
                    "2. high": "125.4050",
                    "3. low": "125.1600",
                    "4. close": "125.1955",
                    "5. volume": "25454"
                },
                "2020-12-18 14:00:00": {
                    "1. open": "125.2900",
                    "2. high": "125.4100",
                    "3. low": "125.2900",
                    "4. close": "125.4100",
                    "5. volume": "15695"
                },
                "2020-12-18 13:55:00": {
                    "1. open": "125.3470",
                    "2. high": "125.3600",
                    "3. low": "125.2600",
                    "4. close": "125.2970",
                    "5. volume": "19843"
                },
                "2020-12-18 13:50:00": {
                    "1. open": "125.3730",
                    "2. high": "125.4400",
                    "3. low": "125.3200",
                    "4. close": "125.3463",
                    "5. volume": "14090"
                },
                "2020-12-18 13:45:00": {
                    "1. open": "125.3100",
                    "2. high": "125.4100",
                    "3. low": "125.2900",
                    "4. close": "125.3793",
                    "5. volume": "30606"
                },
                "2020-12-18 13:40:00": {
                    "1. open": "125.4200",
                    "2. high": "125.4500",
                    "3. low": "125.3000",
                    "4. close": "125.3100",
                    "5. volume": "19884"
                },
                "2020-12-18 13:35:00": {
                    "1. open": "125.6400",
                    "2. high": "125.6700",
                    "3. low": "125.4200",
                    "4. close": "125.4250",
                    "5. volume": "25854"
                },
                "2020-12-18 13:30:00": {
                    "1. open": "125.5898",
                    "2. high": "125.6696",
                    "3. low": "125.5705",
                    "4. close": "125.6500",
                    "5. volume": "17079"
                },
                "2020-12-18 13:25:00": {
                    "1. open": "125.4700",
                    "2. high": "125.6000",
                    "3. low": "125.4350",
                    "4. close": "125.5951",
                    "5. volume": "20086"
                },
                "2020-12-18 13:20:00": {
                    "1. open": "125.5200",
                    "2. high": "125.5200",
                    "3. low": "125.4400",
                    "4. close": "125.4999",
                    "5. volume": "23088"
                },
                "2020-12-18 13:15:00": {
                    "1. open": "125.4750",
                    "2. high": "125.5278",
                    "3. low": "125.4315",
                    "4. close": "125.5278",
                    "5. volume": "19052"
                },
                "2020-12-18 13:10:00": {
                    "1. open": "125.5400",
                    "2. high": "125.5500",
                    "3. low": "125.4500",
                    "4. close": "125.4815",
                    "5. volume": "27962"
                },
                "2020-12-18 13:05:00": {
                    "1. open": "125.6800",
                    "2. high": "125.6900",
                    "3. low": "125.5400",
                    "4. close": "125.5450",
                    "5. volume": "23745"
                },
                "2020-12-18 13:00:00": {
                    "1. open": "125.7400",
                    "2. high": "125.7400",
                    "3. low": "125.6500",
                    "4. close": "125.6750",
                    "5. volume": "29930"
                },
                "2020-12-18 12:55:00": {
                    "1. open": "125.8900",
                    "2. high": "125.9100",
                    "3. low": "125.7100",
                    "4. close": "125.7100",
                    "5. volume": "16959"
                },
                "2020-12-18 12:50:00": {
                    "1. open": "125.9000",
                    "2. high": "125.9100",
                    "3. low": "125.8206",
                    "4. close": "125.8899",
                    "5. volume": "14964"
                },
                "2020-12-18 12:45:00": {
                    "1. open": "126.0000",
                    "2. high": "126.0300",
                    "3. low": "125.8920",
                    "4. close": "125.9000",
                    "5. volume": "16909"
                },
                "2020-12-18 12:40:00": {
                    "1. open": "125.8400",
                    "2. high": "126.0000",
                    "3. low": "125.8400",
                    "4. close": "125.9850",
                    "5. volume": "22346"
                },
                "2020-12-18 12:35:00": {
                    "1. open": "125.8300",
                    "2. high": "125.9200",
                    "3. low": "125.8224",
                    "4. close": "125.8850",
                    "5. volume": "16503"
                },
                "2020-12-18 12:30:00": {
                    "1. open": "125.7650",
                    "2. high": "125.8786",
                    "3. low": "125.7650",
                    "4. close": "125.8339",
                    "5. volume": "15779"
                },
                "2020-12-18 12:25:00": {
                    "1. open": "125.9300",
                    "2. high": "125.9300",
                    "3. low": "125.7600",
                    "4. close": "125.8249",
                    "5. volume": "29469"
                },
                "2020-12-18 12:20:00": {
                    "1. open": "125.7850",
                    "2. high": "126.0400",
                    "3. low": "125.7850",
                    "4. close": "125.9500",
                    "5. volume": "36203"
                },
                "2020-12-18 12:15:00": {
                    "1. open": "125.8000",
                    "2. high": "125.8100",
                    "3. low": "125.7600",
                    "4. close": "125.7874",
                    "5. volume": "14371"
                },
                "2020-12-18 12:10:00": {
                    "1. open": "125.8900",
                    "2. high": "125.9300",
                    "3. low": "125.7900",
                    "4. close": "125.8150",
                    "5. volume": "20835"
                },
                "2020-12-18 12:05:00": {
                    "1. open": "125.4700",
                    "2. high": "125.9100",
                    "3. low": "125.4700",
                    "4. close": "125.9100",
                    "5. volume": "21680"
                },
                "2020-12-18 12:00:00": {
                    "1. open": "125.7100",
                    "2. high": "125.7100",
                    "3. low": "125.4450",
                    "4. close": "125.4500",
                    "5. volume": "33958"
                },
                "2020-12-18 11:55:00": {
                    "1. open": "125.5601",
                    "2. high": "125.7050",
                    "3. low": "125.5300",
                    "4. close": "125.7050",
                    "5. volume": "36019"
                },
                "2020-12-18 11:50:00": {
                    "1. open": "125.4400",
                    "2. high": "125.6000",
                    "3. low": "125.4400",
                    "4. close": "125.5776",
                    "5. volume": "18762"
                },
                "2020-12-18 11:45:00": {
                    "1. open": "125.6300",
                    "2. high": "125.6400",
                    "3. low": "125.4200",
                    "4. close": "125.4200",
                    "5. volume": "23059"
                },
                "2020-12-18 11:40:00": {
                    "1. open": "125.6950",
                    "2. high": "125.8000",
                    "3. low": "125.6600",
                    "4. close": "125.6600",
                    "5. volume": "23196"
                },
                "2020-12-18 11:35:00": {
                    "1. open": "125.6600",
                    "2. high": "125.7300",
                    "3. low": "125.6000",
                    "4. close": "125.7000",
                    "5. volume": "28080"
                },
                "2020-12-18 11:30:00": {
                    "1. open": "125.6020",
                    "2. high": "125.7000",
                    "3. low": "125.5900",
                    "4. close": "125.6764",
                    "5. volume": "37992"
                },
                "2020-12-18 11:25:00": {
                    "1. open": "125.3691",
                    "2. high": "125.6400",
                    "3. low": "125.3400",
                    "4. close": "125.6400",
                    "5. volume": "26753"
                },
                "2020-12-18 11:20:00": {
                    "1. open": "125.0900",
                    "2. high": "125.3800",
                    "3. low": "124.9700",
                    "4. close": "125.3800",
                    "5. volume": "37302"
                },
                "2020-12-18 11:15:00": {
                    "1. open": "125.3875",
                    "2. high": "125.3979",
                    "3. low": "125.0800",
                    "4. close": "125.1050",
                    "5. volume": "27673"
                },
                "2020-12-18 11:10:00": {
                    "1. open": "125.4300",
                    "2. high": "125.4800",
                    "3. low": "125.3000",
                    "4. close": "125.3800",
                    "5. volume": "17894"
                },
                "2020-12-18 11:05:00": {
                    "1. open": "125.5000",
                    "2. high": "125.5589",
                    "3. low": "125.4200",
                    "4. close": "125.4300",
                    "5. volume": "20369"
                },
                "2020-12-18 11:00:00": {
                    "1. open": "125.4250",
                    "2. high": "125.6000",
                    "3. low": "125.4250",
                    "4. close": "125.5300",
                    "5. volume": "24913"
                },
                "2020-12-18 10:55:00": {
                    "1. open": "125.3800",
                    "2. high": "125.5100",
                    "3. low": "125.3750",
                    "4. close": "125.4200",
                    "5. volume": "11539"
                },
                "2020-12-18 10:50:00": {
                    "1. open": "125.5821",
                    "2. high": "125.6000",
                    "3. low": "125.3290",
                    "4. close": "125.4100",
                    "5. volume": "26193"
                },
                "2020-12-18 10:45:00": {
                    "1. open": "125.4400",
                    "2. high": "125.6200",
                    "3. low": "125.3819",
                    "4. close": "125.5600",
                    "5. volume": "23154"
                },
                "2020-12-18 10:40:00": {
                    "1. open": "125.1400",
                    "2. high": "125.4900",
                    "3. low": "125.1160",
                    "4. close": "125.4350",
                    "5. volume": "34045"
                },
                "2020-12-18 10:35:00": {
                    "1. open": "125.2550",
                    "2. high": "125.2900",
                    "3. low": "125.1400",
                    "4. close": "125.1700",
                    "5. volume": "24347"
                },
                "2020-12-18 10:30:00": {
                    "1. open": "125.4600",
                    "2. high": "125.5000",
                    "3. low": "125.1600",
                    "4. close": "125.2600",
                    "5. volume": "27564"
                },
                "2020-12-18 10:25:00": {
                    "1. open": "125.6400",
                    "2. high": "125.6400",
                    "3. low": "125.3700",
                    "4. close": "125.3800",
                    "5. volume": "27091"
                },
                "2020-12-18 10:20:00": {
                    "1. open": "125.9100",
                    "2. high": "125.9100",
                    "3. low": "125.5700",
                    "4. close": "125.6700",
                    "5. volume": "18014"
                },
                "2020-12-18 10:15:00": {
                    "1. open": "125.7400",
                    "2. high": "125.9705",
                    "3. low": "125.6500",
                    "4. close": "125.8803",
                    "5. volume": "22148"
                },
                "2020-12-18 10:10:00": {
                    "1. open": "125.5650",
                    "2. high": "125.7400",
                    "3. low": "125.4900",
                    "4. close": "125.7000",
                    "5. volume": "32276"
                },
                "2020-12-18 10:05:00": {
                    "1. open": "126.0100",
                    "2. high": "126.1500",
                    "3. low": "125.4700",
                    "4. close": "125.5750",
                    "5. volume": "34741"
                },
                "2020-12-18 10:00:00": {
                    "1. open": "125.8200",
                    "2. high": "126.1500",
                    "3. low": "125.7900",
                    "4. close": "126.0100",
                    "5. volume": "31882"
                },
                "2020-12-18 09:55:00": {
                    "1. open": "125.9370",
                    "2. high": "126.1100",
                    "3. low": "125.6400",
                    "4. close": "125.7900",
                    "5. volume": "38614"
                },
                "2020-12-18 09:50:00": {
                    "1. open": "126.0100",
                    "2. high": "126.2400",
                    "3. low": "125.7500",
                    "4. close": "125.9301",
                    "5. volume": "40402"
                },
                "2020-12-18 09:45:00": {
                    "1. open": "126.2200",
                    "2. high": "126.2200",
                    "3. low": "125.7500",
                    "4. close": "126.0450",
                    "5. volume": "39724"
                },
                "2020-12-18 09:40:00": {
                    "1. open": "126.0800",
                    "2. high": "126.3300",
                    "3. low": "126.0000",
                    "4. close": "126.2150",
                    "5. volume": "49290"
                },
                "2020-12-18 09:35:00": {
                    "1. open": "125.5900",
                    "2. high": "126.1400",
                    "3. low": "125.0000",
                    "4. close": "126.1400",
                    "5. volume": "2078431"
                },
                "2020-12-18 09:30:00": {
                    "1. open": "125.5500",
                    "2. high": "125.7500",
                    "3. low": "125.5500",
                    "4. close": "125.7500",
                    "5. volume": "1668"
                },
                "2020-12-18 09:20:00": {
                    "1. open": "125.5500",
                    "2. high": "125.5500",
                    "3. low": "125.5500",
                    "4. close": "125.5500",
                    "5. volume": "309"
                },
                "2020-12-18 08:55:00": {
                    "1. open": "125.5600",
                    "2. high": "125.5700",
                    "3. low": "125.5400",
                    "4. close": "125.5400",
                    "5. volume": "774"
                },
                "2020-12-18 08:50:00": {
                    "1. open": "125.5600",
                    "2. high": "125.5600",
                    "3. low": "125.5600",
                    "4. close": "125.5600",
                    "5. volume": "438"
                },
                "2020-12-18 08:45:00": {
                    "1. open": "125.6900",
                    "2. high": "125.6900",
                    "3. low": "125.5727",
                    "4. close": "125.5727",
                    "5. volume": "368"
                },
                "2020-12-18 08:30:00": {
                    "1. open": "125.7000",
                    "2. high": "125.7000",
                    "3. low": "125.7000",
                    "4. close": "125.7000",
                    "5. volume": "100"
                },
                "2020-12-18 08:20:00": {
                    "1. open": "125.5500",
                    "2. high": "125.5500",
                    "3. low": "125.5500",
                    "4. close": "125.5500",
                    "5. volume": "14557"
                }
            }
        };
        // const parseDate = timeParse("%Y-%m-%d");
        for (let x in data['Time Series (5min)']){
                    resultdata.push({
                        stock_symbol,
                        date: new Date(x),
                        open: data['Time Series (5min)'][x]['1. open'],
                        high: data['Time Series (5min)'][x]['2. high'],
                        low: data['Time Series (5min)'][x]['3. low'],
                        close: data['Time Series (5min)'][x]['4. close'],
                        volume: +data['Time Series (5min)'][x]['5. volume']
                    })
        }
    }catch (e) {
        console.log(e)
        
    }
    // const resultdata = {
    //     stock_symbol,
    //     date: period,
    //     close: closeValues,
    //     open: openValues,
    //     high: highValues,
    //     volume: volumeValues
    // };
    return resultdata;
}
